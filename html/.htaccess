RewriteEngine On

############################################################################
#### Удаляем www                                                        ####
############################################################################
# Проверяем, содержит ли домен www в начале URL.
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
# Перенаправляем удаляем www
RewriteRule ^(.*)$ https://%1/$1 [R=301,L]

############################################################################
#### Перенаправляем протокол http на https                              ####
############################################################################

# Проверяем наличие https в URL.
RewriteCond %{ENV:HTTPS} !on
# Перенаправляем протокол на https.
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]